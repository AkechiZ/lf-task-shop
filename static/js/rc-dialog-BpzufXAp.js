import{e,d as t,g as n,c as o}from"./@babel-Bb0hnufx.js";import{P as a}from"./@rc-component-DKLUhsoK.js";import{r,a as l}from"./react-Dt43AXdo.js";import{c as s}from"./classnames-DuRG1NoC.js";import{e as c,z as i,m as u,C as m,K as d}from"./rc-util-DKUN63E2.js";import{C as f}from"./rc-motion-B-lo2aFh.js";var v=r.createContext({});function p(e,t,n){var o=t;return!o&&n&&(o="".concat(e,"-").concat(n)),o}function y(e,t){var n=e["page".concat(t?"Y":"X","Offset")],o="scroll".concat(t?"Top":"Left");if("number"!=typeof n){var a=e.document;"number"!=typeof(n=a.documentElement[o])&&(n=a.body[o])}return n}const C=r.memo((function(e){return e.children}),(function(e,t){return!t.shouldUpdate}));var b={width:0,height:0,overflow:"hidden",outline:"none"},E={outline:"none"},N=l.forwardRef((function(o,a){var u=o.prefixCls,m=o.className,d=o.style,f=o.title,p=o.ariaId,y=o.footer,N=o.closable,h=o.closeIcon,g=o.onClose,k=o.children,x=o.bodyStyle,R=o.bodyProps,w=o.modalRender,I=o.onMouseDown,P=o.onMouseUp,D=o.holderRef,M=o.visible,S=o.forceRender,j=o.width,O=o.height,T=o.classNames,A=o.styles,U=l.useContext(v).panel,z=c(D,U),V=r.useRef(),K=r.useRef(),L=r.useRef();l.useImperativeHandle(a,(function(){return{focus:function(){var e;null===(e=L.current)||void 0===e||e.focus()},changeActive:function(e){var t=document.activeElement;e&&t===K.current?V.current.focus():e||t!==V.current||K.current.focus()}}}));var B,H,W={};void 0!==j&&(W.width=j),void 0!==O&&(W.height=O),y&&(B=l.createElement("div",{className:s("".concat(u,"-footer"),null==T?void 0:T.footer),style:e({},null==A?void 0:A.footer)},y)),f&&(H=l.createElement("div",{className:s("".concat(u,"-header"),null==T?void 0:T.header),style:e({},null==A?void 0:A.header)},l.createElement("div",{className:"".concat(u,"-title"),id:p},f)));var X,Y=r.useMemo((function(){return"object"===t(N)&&null!==N?N:N?{closeIcon:null!=h?h:l.createElement("span",{className:"".concat(u,"-close-x")})}:{}}),[N,h]),q=i(Y,!0);N&&(X=l.createElement("button",n({type:"button",onClick:g,"aria-label":"Close"},q,{className:"".concat(u,"-close")}),Y.closeIcon));var F=l.createElement("div",{className:s("".concat(u,"-content"),null==T?void 0:T.content),style:null==A?void 0:A.content},X,H,l.createElement("div",n({className:s("".concat(u,"-body"),null==T?void 0:T.body),style:e(e({},x),null==A?void 0:A.body)},R),k),B);return l.createElement("div",{key:"dialog-element",role:"dialog","aria-labelledby":f?p:null,"aria-modal":"true",ref:z,style:e(e({},d),W),className:s(u,m),onMouseDown:I,onMouseUp:P},l.createElement("div",{tabIndex:0,ref:V,style:b,"aria-hidden":"true"}),l.createElement("div",{ref:L,tabIndex:-1,style:E},l.createElement(C,{shouldUpdate:M||S},w?w(F):F)),l.createElement("div",{tabIndex:0,ref:K,style:b,"aria-hidden":"true"}))})),h=r.forwardRef((function(t,a){var l=t.prefixCls,c=t.title,i=t.style,u=t.className,m=t.visible,d=t.forceRender,v=t.destroyOnClose,p=t.motionName,C=t.ariaId,b=t.onVisibleChanged,E=t.mousePosition,h=r.useRef(),g=r.useState(),k=o(g,2),x=k[0],R=k[1],w={};function I(){var e,t,n,o,a,r=(e=h.current,t=e.getBoundingClientRect(),n={left:t.left,top:t.top},o=e.ownerDocument,a=o.defaultView||o.parentWindow,n.left+=y(a),n.top+=y(a,!0),n);R(E?"".concat(E.x-r.left,"px ").concat(E.y-r.top,"px"):"")}return x&&(w.transformOrigin=x),r.createElement(f,{visible:m,onVisibleChanged:b,onAppearPrepare:I,onEnterPrepare:I,forceRender:d,motionName:p,removeOnLeave:v,ref:h},(function(o,m){var d=o.className,f=o.style;return r.createElement(N,n({},t,{ref:a,title:c,ariaId:C,prefixCls:l,holderRef:m,style:e(e(e({},f),i),w),className:s(u,d)}))}))}));function g(t){var o=t.prefixCls,a=t.style,l=t.visible,c=t.maskProps,i=t.motionName,u=t.className;return r.createElement(f,{key:"mask",visible:l,motionName:i,leavedClassName:"".concat(o,"-mask-hidden")},(function(t,l){var i=t.className,m=t.style;return r.createElement("div",n({ref:l,style:e(e({},m),a),className:s("".concat(o,"-mask"),i,u)},c))}))}function k(t){var a=t.prefixCls,l=void 0===a?"rc-dialog":a,c=t.zIndex,f=t.visible,v=void 0!==f&&f,y=t.keyboard,C=void 0===y||y,b=t.focusTriggerAfterClose,E=void 0===b||b,N=t.wrapStyle,k=t.wrapClassName,x=t.wrapProps,R=t.onClose,w=t.afterOpenChange,I=t.afterClose,P=t.transitionName,D=t.animation,M=t.closable,S=void 0===M||M,j=t.mask,O=void 0===j||j,T=t.maskTransitionName,A=t.maskAnimation,U=t.maskClosable,z=void 0===U||U,V=t.maskStyle,K=t.maskProps,L=t.rootClassName,B=t.classNames,H=t.styles,W=r.useRef(),X=r.useRef(),Y=r.useRef(),q=r.useState(v),F=o(q,2),G=F[0],J=F[1],Q=u();function Z(e){null==R||R(e)}var $=r.useRef(!1),_=r.useRef(),ee=null;return z&&(ee=function(e){$.current?$.current=!1:X.current===e.target&&Z(e)}),r.useEffect((function(){v&&(J(!0),m(X.current,document.activeElement)||(W.current=document.activeElement))}),[v]),r.useEffect((function(){return function(){clearTimeout(_.current)}}),[]),r.createElement("div",n({className:s("".concat(l,"-root"),L)},i(t,{data:!0})),r.createElement(g,{prefixCls:l,visible:O&&v,motionName:p(l,T,A),style:e(e({zIndex:c},V),null==H?void 0:H.mask),maskProps:K,className:null==B?void 0:B.mask}),r.createElement("div",n({tabIndex:-1,onKeyDown:function(e){if(C&&e.keyCode===d.ESC)return e.stopPropagation(),void Z(e);v&&e.keyCode===d.TAB&&Y.current.changeActive(!e.shiftKey)},className:s("".concat(l,"-wrap"),k,null==B?void 0:B.wrapper),ref:X,onClick:ee,style:e(e(e({zIndex:c},N),null==H?void 0:H.wrapper),{},{display:G?null:"none"})},x),r.createElement(h,n({},t,{onMouseDown:function(){clearTimeout(_.current),$.current=!0},onMouseUp:function(){_.current=setTimeout((function(){$.current=!1}))},ref:Y,closable:S,ariaId:Q,prefixCls:l,visible:v&&G,onClose:Z,onVisibleChanged:function(e){if(e)m(X.current,document.activeElement)||null===(t=Y.current)||void 0===t||t.focus();else{if(J(!1),O&&W.current&&E){try{W.current.focus({preventScroll:!0})}catch(n){}W.current=null}G&&(null==I||I())}var t;null==w||w(e)},motionName:p(l,P,D)}))))}h.displayName="Content";var x=function(e){var t=e.visible,l=e.getContainer,s=e.forceRender,c=e.destroyOnClose,i=void 0!==c&&c,u=e.afterClose,m=e.panelRef,d=r.useState(t),f=o(d,2),p=f[0],y=f[1],C=r.useMemo((function(){return{panel:m}}),[m]);return r.useEffect((function(){t&&y(!0)}),[t]),s||!i||p?r.createElement(v.Provider,{value:C},r.createElement(a,{open:t||s||p,autoDestroy:!1,getContainer:l,autoLock:t||p},r.createElement(k,n({},e,{destroyOnClose:i,afterClose:function(){null==u||u(),y(!1)}})))):null};x.displayName="Dialog";export{x as D};
