import{c as e,d as t,g as n,b as o,h as r,e as c,f as s}from"./@babel-Bb0hnufx.js";import{r as a,a as i}from"./react-Dt43AXdo.js";import{r as l}from"./react-dom-DXzNLLV7.js";import{c as u}from"./classnames-DuRG1NoC.js";import{a as f}from"./rc-motion-B-lo2aFh.js";import{z as d,K as m}from"./rc-util-DKUN63E2.js";var v=a.forwardRef((function(r,c){var s=r.prefixCls,i=r.style,l=r.className,f=r.duration,v=void 0===f?4.5:f,y=r.eventKey,p=r.content,h=r.closable,k=r.closeIcon,g=void 0===k?"x":k,N=r.props,E=r.onClick,C=r.onNoticeClose,x=r.times,b=r.hovering,R=a.useState(!1),j=e(R,2),A=j[0],S=j[1],w=b||A,M=function(){C(y)};a.useEffect((function(){if(!w&&v>0){var e=setTimeout((function(){M()}),1e3*v);return function(){clearTimeout(e)}}}),[v,w,x]);var I=a.useMemo((function(){return"object"===t(h)&&null!==h?h:h?{closeIcon:g}:{}}),[h,g]),L=d(I,!0),W="".concat(s,"-notice");return a.createElement("div",n({},N,{ref:c,className:u(W,l,o({},"".concat(W,"-closable"),h)),style:i,onMouseEnter:function(e){var t;S(!0),null==N||null===(t=N.onMouseEnter)||void 0===t||t.call(N,e)},onMouseLeave:function(e){var t;S(!1),null==N||null===(t=N.onMouseLeave)||void 0===t||t.call(N,e)},onClick:E}),a.createElement("div",{className:"".concat(W,"-content")},p),h&&a.createElement("a",n({tabIndex:0,className:"".concat(W,"-close"),onKeyDown:function(e){"Enter"!==e.key&&"Enter"!==e.code&&e.keyCode!==m.ENTER||M()},"aria-label":"Close"},L,{onClick:function(e){e.preventDefault(),e.stopPropagation(),M()}}),I.closeIcon))})),y=i.createContext({}),p=function(e){var t=e.children,n=e.classNames;return i.createElement(y.Provider,{value:{classNames:n}},t)},h=["className","style","classNames","styles"],k=function(l){var d,m,p,k,g,N=l.configList,E=l.placement,C=l.prefixCls,x=l.className,b=l.style,R=l.motion,j=l.onAllNoticeRemoved,A=l.onNoticeClose,S=l.stack,w=a.useContext(y).classNames,M=a.useRef({}),I=a.useState(null),L=e(I,2),W=L[0],H=L[1],K=a.useState([]),O=e(K,2),P=O[0],T=O[1],D=N.map((function(e){return{config:e,key:String(e.key)}})),z=(g={offset:8,threshold:3,gap:16},(d=S)&&"object"===t(d)&&(g.offset=null!==(m=d.offset)&&void 0!==m?m:8,g.threshold=null!==(p=d.threshold)&&void 0!==p?p:3,g.gap=null!==(k=d.gap)&&void 0!==k?k:16),[!!d,g]),F=e(z,2),X=F[0],q=F[1],B=q.offset,G=q.threshold,J=q.gap,Q=X&&(P.length>0||D.length<=G),U="function"==typeof R?R(E):R;return a.useEffect((function(){X&&P.length>1&&T((function(e){return e.filter((function(e){return D.some((function(t){var n=t.key;return e===n}))}))}))}),[P,D,X]),a.useEffect((function(){var e,t;X&&M.current[null===(e=D[D.length-1])||void 0===e?void 0:e.key]&&H(M.current[null===(t=D[D.length-1])||void 0===t?void 0:t.key])}),[D,X]),i.createElement(f,n({key:E,className:u(C,"".concat(C,"-").concat(E),null==w?void 0:w.list,x,o(o({},"".concat(C,"-stack"),!!X),"".concat(C,"-stack-expanded"),Q)),style:b,keys:D,motionAppear:!0},U,{onAllRemoved:function(){j(E)}}),(function(e,t){var o=e.config,a=e.className,l=e.style,f=e.index,d=o,m=d.key,y=d.times,p=String(m),k=o,g=k.className,N=k.style,x=k.classNames,b=k.styles,R=r(k,h),j=D.findIndex((function(e){return e.key===p})),S={};if(X){var I=D.length-1-(j>-1?j:f-1),L="top"===E||"bottom"===E?"-50%":"0";if(I>0){var H,K,O;S.height=Q?null===(H=M.current[p])||void 0===H?void 0:H.offsetHeight:null==W?void 0:W.offsetHeight;for(var z=0,F=0;F<I;F++){var q;z+=(null===(q=M.current[D[D.length-1-F].key])||void 0===q?void 0:q.offsetHeight)+J}var G=(Q?z:I*B)*(E.startsWith("top")?1:-1),U=!Q&&null!=W&&W.offsetWidth&&null!==(K=M.current[p])&&void 0!==K&&K.offsetWidth?((null==W?void 0:W.offsetWidth)-2*B*(I<3?I:3))/(null===(O=M.current[p])||void 0===O?void 0:O.offsetWidth):1;S.transform="translate3d(".concat(L,", ").concat(G,"px, 0) scaleX(").concat(U,")")}else S.transform="translate3d(".concat(L,", 0, 0)")}return i.createElement("div",{ref:t,className:u("".concat(C,"-notice-wrapper"),a,null==x?void 0:x.wrapper),style:c(c(c({},l),S),null==b?void 0:b.wrapper),onMouseEnter:function(){return T((function(e){return e.includes(p)?e:[].concat(s(e),[p])}))},onMouseLeave:function(){return T((function(e){return e.filter((function(e){return e!==p}))}))}},i.createElement(v,n({},R,{ref:function(e){j>-1?M.current[p]=e:delete M.current[p]},prefixCls:C,classNames:x,styles:b,className:u(g,null==w?void 0:w.notice),style:N,times:y,key:m,eventKey:m,onNoticeClose:A,hovering:X&&P.length>0})))}))},g=a.forwardRef((function(t,n){var o=t.prefixCls,r=void 0===o?"rc-notification":o,i=t.container,u=t.motion,f=t.maxCount,d=t.className,m=t.style,v=t.onAllRemoved,y=t.stack,p=t.renderNotifications,h=a.useState([]),g=e(h,2),N=g[0],E=g[1],C=function(e){var t,n=N.find((function(t){return t.key===e}));null==n||null===(t=n.onClose)||void 0===t||t.call(n),E((function(t){return t.filter((function(t){return t.key!==e}))}))};a.useImperativeHandle(n,(function(){return{open:function(e){E((function(t){var n,o=s(t),r=o.findIndex((function(t){return t.key===e.key})),a=c({},e);r>=0?(a.times=((null===(n=t[r])||void 0===n?void 0:n.times)||0)+1,o[r]=a):(a.times=0,o.push(a));return f>0&&o.length>f&&(o=o.slice(-f)),o}))},close:function(e){C(e)},destroy:function(){E([])}}}));var x=a.useState({}),b=e(x,2),R=b[0],j=b[1];a.useEffect((function(){var e={};N.forEach((function(t){var n=t.placement,o=void 0===n?"topRight":n;o&&(e[o]=e[o]||[],e[o].push(t))})),Object.keys(R).forEach((function(t){e[t]=e[t]||[]})),j(e)}),[N]);var A=function(e){j((function(t){var n=c({},t);return(n[e]||[]).length||delete n[e],n}))},S=a.useRef(!1);if(a.useEffect((function(){Object.keys(R).length>0?S.current=!0:S.current&&(null==v||v(),S.current=!1)}),[R]),!i)return null;var w=Object.keys(R);return l.createPortal(a.createElement(a.Fragment,null,w.map((function(e){var t=R[e],n=a.createElement(k,{key:e,configList:t,placement:e,prefixCls:r,className:null==d?void 0:d(e),style:null==m?void 0:m(e),motion:u,onNoticeClose:C,onAllNoticeRemoved:A,stack:y});return p?p(n,{prefixCls:r,key:e}):n}))),i)})),N=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","stack","renderNotifications"],E=function(){return document.body},C=0;function x(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.getContainer,o=void 0===n?E:n,c=t.motion,i=t.prefixCls,l=t.maxCount,u=t.className,f=t.style,d=t.onAllRemoved,m=t.stack,v=t.renderNotifications,y=r(t,N),p=a.useState(),h=e(p,2),k=h[0],x=h[1],b=a.useRef(),R=a.createElement(g,{container:k,ref:b,prefixCls:i,motion:c,maxCount:l,className:u,style:f,onAllRemoved:d,stack:m,renderNotifications:v}),j=a.useState([]),A=e(j,2),S=A[0],w=A[1],M=a.useMemo((function(){return{open:function(e){var t=function(){for(var e={},t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return n.forEach((function(t){t&&Object.keys(t).forEach((function(n){var o=t[n];void 0!==o&&(e[n]=o)}))})),e}(y,e);null!==t.key&&void 0!==t.key||(t.key="rc-notification-".concat(C),C+=1),w((function(e){return[].concat(s(e),[{type:"open",config:t}])}))},close:function(e){w((function(t){return[].concat(s(t),[{type:"close",key:e}])}))},destroy:function(){w((function(e){return[].concat(s(e),[{type:"destroy"}])}))}}}),[]);return a.useEffect((function(){x(o())})),a.useEffect((function(){b.current&&S.length&&(S.forEach((function(e){switch(e.type){case"open":b.current.open(e.config);break;case"close":b.current.close(e.key);break;case"destroy":b.current.destroy()}})),w((function(e){return e.filter((function(e){return!S.includes(e)}))})))}),[S]),[M,R]}export{p as N,x as u};
