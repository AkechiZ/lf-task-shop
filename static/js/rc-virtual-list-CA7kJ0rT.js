import{e,b as t,g as n,c as r,_ as o,a as i,d as u,h as a}from"./@babel-Bb0hnufx.js";import{r as c}from"./react-Dt43AXdo.js";import{r as l}from"./react-dom-DXzNLLV7.js";import{c as s}from"./classnames-DuRG1NoC.js";import{R as f}from"./rc-resize-observer-kawTBywu.js";import{t as v,I as d,u as h,i as m}from"./rc-util-DKUN63E2.js";var g=c.forwardRef((function(r,o){var i=r.height,u=r.offsetY,a=r.offsetX,l=r.children,v=r.prefixCls,d=r.onInnerResize,h=r.innerProps,m=r.rtl,g=r.extra,p={},b={display:"flex",flexDirection:"column"};return void 0!==u&&(p={height:i,position:"relative",overflow:"hidden"},b=e(e({},b),{},t(t(t(t(t({transform:"translateY(".concat(u,"px)")},m?"marginRight":"marginLeft",-a),"position","absolute"),"left",0),"right",0),"top",0))),c.createElement("div",{style:p},c.createElement(f,{onResize:function(e){e.offsetHeight&&d&&d()}},c.createElement("div",n({style:b,className:s(t({},"".concat(v,"-holder-inner"),v)),ref:o},h),l,g)))}));function p(e,t){return("touches"in e?e.touches[0]:e)[t?"pageX":"pageY"]}g.displayName="Filler";var b=c.forwardRef((function(n,o){var i=n.prefixCls,u=n.rtl,a=n.scrollOffset,l=n.scrollRange,f=n.onStartMove,d=n.onStopMove,h=n.onScroll,m=n.horizontal,g=n.spinSize,b=n.containerSize,M=n.style,R=n.thumbStyle,S=c.useState(!1),E=r(S,2),w=E[0],y=E[1],x=c.useState(null),L=r(x,2),H=L[0],z=L[1],T=c.useState(null),Y=r(T,2),N=Y[0],k=Y[1],D=!u,I=c.useRef(),j=c.useRef(),C=c.useState(!1),P=r(C,2),O=P[0],A=P[1],X=c.useRef(),_=function(){clearTimeout(X.current),A(!0),X.current=setTimeout((function(){A(!1)}),3e3)},K=l-b||0,B=b-g||0,V=c.useMemo((function(){return 0===a||0===K?0:a/K*B}),[a,K,B]),W=c.useRef({top:V,dragging:w,pageY:H,startTop:N});W.current={top:V,dragging:w,pageY:H,startTop:N};var F=function(e){y(!0),z(p(e,m)),k(W.current.top),f(),e.stopPropagation(),e.preventDefault()};c.useEffect((function(){var e=function(e){e.preventDefault()},t=I.current,n=j.current;return t.addEventListener("touchstart",e),n.addEventListener("touchstart",F),function(){t.removeEventListener("touchstart",e),n.removeEventListener("touchstart",F)}}),[]);var q=c.useRef();q.current=K;var G=c.useRef();G.current=B,c.useEffect((function(){if(w){var e,t=function(t){var n=W.current,r=n.dragging,o=n.pageY,i=n.startTop;if(v.cancel(e),r){var u=p(t,m)-o,a=i;!D&&m?a-=u:a+=u;var c=q.current,l=G.current,s=l?a/l:0,f=Math.ceil(s*c);f=Math.max(f,0),f=Math.min(f,c),e=v((function(){h(f,m)}))}},n=function(){y(!1),d()};return window.addEventListener("mousemove",t),window.addEventListener("touchmove",t),window.addEventListener("mouseup",n),window.addEventListener("touchend",n),function(){window.removeEventListener("mousemove",t),window.removeEventListener("touchmove",t),window.removeEventListener("mouseup",n),window.removeEventListener("touchend",n),v.cancel(e)}}}),[w]),c.useEffect((function(){_()}),[a]),c.useImperativeHandle(o,(function(){return{delayHidden:_}}));var J="".concat(i,"-scrollbar"),Q={position:"absolute",visibility:O?null:"hidden"},U={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return m?(Q.height=8,Q.left=0,Q.right=0,Q.bottom=0,U.height="100%",U.width=g,D?U.left=V:U.right=V):(Q.width=8,Q.top=0,Q.bottom=0,D?Q.right=0:Q.left=0,U.width="100%",U.height=g,U.top=V),c.createElement("div",{ref:I,className:s(J,t(t(t({},"".concat(J,"-horizontal"),m),"".concat(J,"-vertical"),!m),"".concat(J,"-visible"),O)),style:e(e({},Q),M),onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},onMouseMove:_},c.createElement("div",{ref:j,className:s("".concat(J,"-thumb"),t({},"".concat(J,"-thumb-moving"),w)),style:e(e({},U),R),onMouseDown:F}))}));function M(e){var t=e.children,n=e.setRef,r=c.useCallback((function(e){n(e)}),[]);return c.cloneElement(t,{ref:r})}var R=function(){function e(){i(this,e),t(this,"maps",void 0),t(this,"id",0),this.maps=Object.create(null)}return o(e,[{key:"set",value:function(e,t){this.maps[e]=t,this.id+=1}},{key:"get",value:function(e){return this.maps[e]}}]),e}();var S=10;function E(e,t,n){var o=c.useState(e),i=r(o,2),u=i[0],a=i[1],l=c.useState(null),s=r(l,2),f=s[0],v=s[1];return c.useEffect((function(){var r=function(e,t,n){var r,o,i=e.length,u=t.length;if(0===i&&0===u)return null;i<u?(r=e,o=t):(r=t,o=e);var a={__EMPTY_ITEM__:!0};function c(e){return void 0!==e?n(e):a}for(var l=null,s=1!==Math.abs(i-u),f=0;f<o.length;f+=1){var v=c(r[f]);if(v!==c(o[f])){l=f,s=s||v!==c(o[f+1]);break}}return null===l?null:{index:l,multiple:s}}(u||[],e||[],t);void 0!==(null==r?void 0:r.index)&&(null==n||n(r.index),v(e[r.index])),a(e)}),[e]),[f]}var w="object"===("undefined"==typeof navigator?"undefined":u(navigator))&&/Firefox/i.test(navigator.userAgent);const y=function(e,t){var n=c.useRef(!1),r=c.useRef(null);var o=c.useRef({top:e,bottom:t});return o.current.top=e,o.current.bottom=t,function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e<0&&o.current.top||e>0&&o.current.bottom;return t&&i?(clearTimeout(r.current),n.current=!1):i&&!n.current||(clearTimeout(r.current),n.current=!0,r.current=setTimeout((function(){n.current=!1}),50)),!n.current&&i}};function x(e,t,n,r,o){var i=c.useRef(0),u=c.useRef(null),a=c.useRef(null),l=c.useRef(!1),s=y(t,n);var f=c.useRef(null),d=c.useRef(null);return[function(t){if(e){v.cancel(d.current),d.current=v((function(){f.current=null}),2);var n=t.deltaX,c=t.deltaY,h=t.shiftKey,m=n,g=c;("sx"===f.current||!f.current&&h&&c&&!n)&&(m=c,g=0,f.current="sx");var p=Math.abs(m),b=Math.abs(g);null===f.current&&(f.current=r&&p>b?"x":"y"),"y"===f.current?function(e,t){v.cancel(u.current),i.current+=t,a.current=t,s(t)||(w||e.preventDefault(),u.current=v((function(){var e=l.current?10:1;o(i.current*e),i.current=0})))}(t,g):function(e,t){o(t,!0),w||e.preventDefault()}(t,m)}},function(t){e&&(l.current=t.detail===a.current)}]}var L=14/15;var H=20;function z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=e/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)*e;return isNaN(t)&&(t=0),t=Math.max(t,H),Math.floor(t)}var T=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles"],Y=[],N={overflowY:"auto",overflowAnchor:"none"};function k(o,i){var p=o.prefixCls,w=void 0===p?"rc-virtual-list":p,H=o.className,k=o.height,D=o.itemHeight,I=o.fullHeight,j=void 0===I||I,C=o.style,P=o.data,O=o.children,A=o.itemKey,X=o.virtual,_=o.direction,K=o.scrollWidth,B=o.component,V=void 0===B?"div":B,W=o.onScroll,F=o.onVirtualScroll,q=o.onVisibleChange,G=o.innerProps,J=o.extraRender,Q=o.styles,U=a(o,T),Z=c.useCallback((function(e){return"function"==typeof A?A(e):null==e?void 0:e[A]}),[A]),$=function(e,t,n){var o=c.useState(0),i=r(o,2),u=i[0],a=i[1],l=c.useRef(new Map),s=c.useRef(new R),f=c.useRef();function h(){v.cancel(f.current)}function m(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];h();var t=function(){l.current.forEach((function(e,t){if(e&&e.offsetParent){var n=d(e),r=n.offsetHeight;s.current.get(t)!==r&&s.current.set(t,n.offsetHeight)}})),a((function(e){return e+1}))};e?t():f.current=v(t)}return c.useEffect((function(){return h}),[]),[function(r,o){var i=e(r),u=l.current.get(i);o?(l.current.set(i,o),m()):l.current.delete(i),!u!=!o&&(o?null==t||t(r):null==n||n(r))},m,s.current,u]}(Z,null,null),ee=r($,4),te=ee[0],ne=ee[1],re=ee[2],oe=ee[3],ie=!(!1===X||!k||!D),ue=c.useMemo((function(){return Object.values(re.maps).reduce((function(e,t){return e+t}),0)}),[re.id,re.maps]),ae=ie&&P&&(Math.max(D*P.length,ue)>k||!!K),ce="rtl"===_,le=s(w,t({},"".concat(w,"-rtl"),ce),H),se=P||Y,fe=c.useRef(),ve=c.useRef(),de=c.useState(0),he=r(de,2),me=he[0],ge=he[1],pe=c.useState(0),be=r(pe,2),Me=be[0],Re=be[1],Se=c.useState(!1),Ee=r(Se,2),we=Ee[0],ye=Ee[1],xe=function(){ye(!0)},Le=function(){ye(!1)},He={getKey:Z};function ze(e){ge((function(t){var n=function(e){var t=e;Number.isNaN(qe.current)||(t=Math.min(t,qe.current));return t=Math.max(t,0),t}("function"==typeof e?e(t):e);return fe.current.scrollTop=n,n}))}var Te=c.useRef({start:0,end:se.length}),Ye=c.useRef(),Ne=E(se,Z),ke=r(Ne,1)[0];Ye.current=ke;var De=c.useMemo((function(){if(!ie)return{scrollHeight:void 0,start:0,end:se.length-1,offset:void 0};var e;if(!ae)return{scrollHeight:(null===(e=ve.current)||void 0===e?void 0:e.offsetHeight)||0,start:0,end:se.length-1,offset:void 0};for(var t,n,r,o=0,i=se.length,u=0;u<i;u+=1){var a=se[u],c=Z(a),l=re.get(c),s=o+(void 0===l?D:l);s>=me&&void 0===t&&(t=u,n=o),s>me+k&&void 0===r&&(r=u),o=s}return void 0===t&&(t=0,n=0,r=Math.ceil(k/D)),void 0===r&&(r=se.length-1),{scrollHeight:o,start:t,end:r=Math.min(r+1,se.length-1),offset:n}}),[ae,ie,me,se,oe,k]),Ie=De.scrollHeight,je=De.start,Ce=De.end,Pe=De.offset;Te.current.start=je,Te.current.end=Ce;var Oe=c.useState({width:0,height:k}),Ae=r(Oe,2),Xe=Ae[0],_e=Ae[1],Ke=c.useRef(),Be=c.useRef(),Ve=c.useMemo((function(){return z(Xe.width,K)}),[Xe.width,K]),We=c.useMemo((function(){return z(Xe.height,Ie)}),[Xe.height,Ie]),Fe=Ie-k,qe=c.useRef(Fe);qe.current=Fe;var Ge=me<=0,Je=me>=Fe,Qe=y(Ge,Je),Ue=function(){return{x:ce?-Me:Me,y:me}},Ze=c.useRef(Ue()),$e=m((function(){if(F){var e=Ue();Ze.current.x===e.x&&Ze.current.y===e.y||(F(e),Ze.current=e)}}));function et(e,t){var n=e;t?(l.flushSync((function(){Re(n)})),$e()):ze(n)}var tt=function(e){var t=e,n=K?K-Xe.width:0;return t=Math.max(t,0),t=Math.min(t,n)},nt=m((function(e,t){t?(l.flushSync((function(){Re((function(t){return tt(t+(ce?-e:e))}))})),$e()):ze((function(t){return t+e}))})),rt=x(ie,Ge,Je,!!K,nt),ot=r(rt,2),it=ot[0],ut=ot[1];!function(e,t,n){var r,o=c.useRef(!1),i=c.useRef(0),u=c.useRef(null),a=c.useRef(null),l=function(e){if(o.current){var t=Math.ceil(e.touches[0].pageY),r=i.current-t;i.current=t,n(r)&&e.preventDefault(),clearInterval(a.current),a.current=setInterval((function(){(!n(r*=L,!0)||Math.abs(r)<=.1)&&clearInterval(a.current)}),16)}},s=function(){o.current=!1,r()},f=function(e){r(),1!==e.touches.length||o.current||(o.current=!0,i.current=Math.ceil(e.touches[0].pageY),u.current=e.target,u.current.addEventListener("touchmove",l),u.current.addEventListener("touchend",s))};r=function(){u.current&&(u.current.removeEventListener("touchmove",l),u.current.removeEventListener("touchend",s))},h((function(){return e&&t.current.addEventListener("touchstart",f),function(){var e;null===(e=t.current)||void 0===e||e.removeEventListener("touchstart",f),r(),clearInterval(a.current)}}),[e])}(ie,fe,(function(e,t){return!Qe(e,t)&&(it({preventDefault:function(){},deltaY:e}),!0)})),h((function(){function e(e){ie&&e.preventDefault()}var t=fe.current;return t.addEventListener("wheel",it),t.addEventListener("DOMMouseScroll",ut),t.addEventListener("MozMousePixelScroll",e),function(){t.removeEventListener("wheel",it),t.removeEventListener("DOMMouseScroll",ut),t.removeEventListener("MozMousePixelScroll",e)}}),[ie]),h((function(){K&&Re((function(e){return tt(e)}))}),[Xe.width,K]);var at=function(){var e,t;null===(e=Ke.current)||void 0===e||e.delayHidden(),null===(t=Be.current)||void 0===t||t.delayHidden()},ct=function(t,n,o,i,a,l,s,f){var d=c.useRef(),m=c.useState(null),g=r(m,2),p=g[0],b=g[1];return h((function(){if(p&&p.times<S){if(!t.current)return void b((function(t){return e({},t)}));l();var r=p.targetAlign,u=p.originAlign,c=p.index,f=p.offset,v=t.current.clientHeight,d=!1,h=r,m=null;if(v){for(var g=r||u,M=0,R=0,E=0,w=Math.min(n.length-1,c),y=0;y<=w;y+=1){var x=a(n[y]);R=M;var L=o.get(x);M=E=R+(void 0===L?i:L)}for(var H="top"===g?f:v-f,z=w;z>=0;z-=1){var T=a(n[z]),Y=o.get(T);if(void 0===Y){d=!0;break}if((H-=Y)<=0)break}switch(g){case"top":m=R-f;break;case"bottom":m=E-v+f;break;default:var N=t.current.scrollTop;R<N?h="top":E>N+v&&(h="bottom")}null!==m&&s(m),m!==p.lastTop&&(d=!0)}d&&b(e(e({},p),{},{times:p.times+1,targetAlign:h,lastTop:m}))}}),[p,t.current]),function(e){if(null!=e){if(v.cancel(d.current),"number"==typeof e)s(e);else if(e&&"object"===u(e)){var t,r=e.align;t="index"in e?e.index:n.findIndex((function(t){return a(t)===e.key}));var o=e.offset;b({times:0,index:t,offset:void 0===o?0:o,originAlign:r})}}else f()}}(fe,se,re,D,Z,(function(){return ne(!0)}),ze,at);c.useImperativeHandle(i,(function(){return{getScrollInfo:Ue,scrollTo:function(e){var t;(t=e)&&"object"===u(t)&&("left"in t||"top"in t)?(void 0!==e.left&&Re(tt(e.left)),ct(e.top)):ct(e)}}})),h((function(){if(q){var e=se.slice(je,Ce+1);q(e,se)}}),[je,Ce,se]);var lt=function(e,t,n,o){var i=c.useMemo((function(){return[new Map,[]]}),[e,n.id,o]),u=r(i,2),a=u[0],l=u[1];return function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,u=a.get(r),c=a.get(i);if(void 0===u||void 0===c)for(var s=e.length,f=l.length;f<s;f+=1){var v,d=e[f],h=t(d);a.set(h,f);var m=null!==(v=n.get(h))&&void 0!==v?v:o;if(l[f]=(l[f-1]||0)+m,h===r&&(u=f),h===i&&(c=f),void 0!==u&&void 0!==c)break}return{top:l[u-1]||0,bottom:l[c]}}}(se,Z,re,D),st=null==J?void 0:J({start:je,end:Ce,virtual:ae,offsetX:Me,offsetY:Pe,rtl:ce,getSize:lt}),ft=function(e,t,n,r,o,i,u){var a=u.getKey;return e.slice(t,n+1).map((function(e,n){var u=i(e,t+n,{style:{width:r}}),l=a(e);return c.createElement(M,{key:l,setRef:function(t){return o(e,t)}},u)}))}(se,je,Ce,K,te,O,He),vt=null;k&&(vt=e(t({},j?"height":"maxHeight",k),N),ie&&(vt.overflowY="hidden",K&&(vt.overflowX="hidden"),we&&(vt.pointerEvents="none")));var dt={};return ce&&(dt.dir="rtl"),c.createElement("div",n({style:e(e({},C),{},{position:"relative"}),className:le},dt,U),c.createElement(f,{onResize:function(e){_e({width:e.width||e.offsetWidth,height:e.height||e.offsetHeight})}},c.createElement(V,{className:"".concat(w,"-holder"),style:vt,ref:fe,onScroll:function(e){var t=e.currentTarget.scrollTop;t!==me&&ze(t),null==W||W(e),$e()},onMouseEnter:at},c.createElement(g,{prefixCls:w,height:Ie,offsetX:Me,offsetY:Pe,scrollWidth:K,onInnerResize:ne,ref:ve,innerProps:G,rtl:ce,extra:st},ft))),ae&&Ie>k&&c.createElement(b,{ref:Ke,prefixCls:w,scrollOffset:me,scrollRange:Ie,rtl:ce,onScroll:et,onStartMove:xe,onStopMove:Le,spinSize:We,containerSize:Xe.height,style:null==Q?void 0:Q.verticalScrollBar,thumbStyle:null==Q?void 0:Q.verticalScrollBarThumb}),ae&&K>Xe.width&&c.createElement(b,{ref:Be,prefixCls:w,scrollOffset:Me,scrollRange:K,rtl:ce,onScroll:et,onStartMove:xe,onStopMove:Le,spinSize:Ve,containerSize:Xe.width,horizontal:!0,style:null==Q?void 0:Q.horizontalScrollBar,thumbStyle:null==Q?void 0:Q.horizontalScrollBarThumb}))}var D=c.forwardRef(k);D.displayName="List";export{D as L};
